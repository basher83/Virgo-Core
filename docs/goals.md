# Goals

## Core Goals

-   [ ] Ansible collection to fully manage Proxmox VE 9.x homelab

    -   [ ] PVE networking configuration
        -   [ ] Manage `/etc/network/interfaces`
        -   [ ] Manage corosync configuration `/etc/corosync/corosync.conf`
        -   [ ] Manage hosts configuration `/etc/hosts`
        -   [ ] VLAN configuration
        -   [ ] DHCP configuration
        -   [ ] DNS configuration
    -   [ ] PVE storage configuration
        -   [ ] CEPH cluster configuration and management
            -   [ ] Each node has a monitor
            -   [ ] Each node has a manager
            -   [ ] Each node has 4 OSD's ((2 OSD's per NVME) x 2 NVME's per node)

-   Gotchas
    -   [ ] Ensure Unifi Controller has jumbo frames enabled for high bandwidth ports

## Current Configuration

### Naming Conventions

-   Cluster is named `Matrix`

-   Each node is named via military phonetic alphabet
    -   `Foxtrot`
    -   `Golf`
    -   `Hotel`

### Hardware Configuration

-   Each node has the following hardware:
    -   System/Chassis: MINISFORUM MS-A2 (mini PC)
    -   Motherboard: Shenzhen Meigao F1WSA
    -   Audio: Realtek ALC245 onboard
    -   Wireless: MediaTek WiFi adapter
    -   1x AMD Ryzen 9 9955HX 16-Core Processor (32 Threads)
    -   2× 32GB A-DATA DDR5 SODIMMs (model CBDAD5S560032G-BAD) running at 5600 MT/s
        in dual-channel configuration for a total of 64GB RAM
    -   2x 4TB Samsung 990 PRO NVMe drives
    -   1x 1TB Crucial P3 (model CT1000P3PSSD8) NVMe drive
    -   1x Realtek RTL8125 2.5GbE
    -   1x Intel I226-V Gigabit
    -   2x Intel X710 10GbE SFP+ (dual-port)
    -   AMD Radeon Graphics (Granite Ridge integrated)

### PVE Storage Configuration

-   Each node has three identical NVME drives:

```bash
nvme1n1              3.6T disk
nvme2n1              3.6T disk
nvme0n1            931.5G disk
├─nvme0n1p1         1007K part
├─nvme0n1p2            1G part vfat        /boot/efi
└─nvme0n1p3        930.5G part LVM2_member

```

-   nvme0n1 is the boot disk

-   nvme1n1 and nvme2n1 are reserved for CEPH cluster storage

### PVE Networking Configuration

-   Each node has four network interfaces:

```bash
enp5s0f0np0            10Gbps DAC - Active
enp5s0f1np1            10Gbps DAC - Active
enp3s0            2.5Gbps Ethernet - Not active
enp4s0            2.5Gbps Ethernet - Active

```

-   enp5s0f0np0 is the CEPH Public network interface

-   enp5s0f1np1 is the CEPH Private network interface

-   enp3s0 is not currently used

-   enp4s0 is the management network interface with VLAN 9 for Corosync

### Foxtrot configuration settings

```bash

# /etc/network/interfaces

# network interface settings; autogenerated

# Please do NOT modify this file directly, unless you know what

# you're doing.
#

# If you want to manage parts of the network configuration manually,

# please utilize the 'source' or 'source-directory' directives to do

# so.

# PVE will preserve these directives, but will NOT read its network

# configuration from sourced files, so do not attempt to move any of

# the PVE managed interfaces into external files!

auto lo
iface lo inet loopback

auto enp4s0
iface enp4s0 inet manual
#MGMT-Coro

iface enp3s0 inet manual

auto enp5s0f0np0
iface enp5s0f0np0 inet manual
  mtu 9000
#CEPH Public

auto enp5s0f1np1
iface enp5s0f1np1 inet manual
  mtu 9000
#CEPH Private

auto vmbr0
iface vmbr0 inet static
  address 192.168.3.5/24
  gateway 192.168.3.1
  bridge-ports enp4s0
  bridge-stp off
  bridge-fd 0
  bridge-vlan-aware yes
  bridge-vids 9
#MGMT

iface wlp6s0 inet manual

auto vmbr1
iface vmbr1 inet static
  address 192.168.5.5/24
  bridge-ports enp5s0f0np0
  bridge-stp off
  bridge-fd 0
  mtu 9000
#CEPH Public

auto vmbr2
iface vmbr2 inet static
  address 192.168.7.5/24
  bridge-ports enp5s0f1np1
  bridge-stp off
  bridge-fd 0
  mtu 9000
#CEPH Private

auto vlan9
iface vlan9 inet static
  address 192.168.8.5/24
  vlan-raw-device vmbr0
#Corosync

source /etc/network/interfaces.d/*

```

```bash

# /etc/hosts

127.0.0.1 localhost.localdomain localhost
192.168.3.5 foxtrot.matrix.spaceships.work foxtrot

# The following lines are desirable for IPv6 capable hosts

::1     ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
ff02::3 ip6-allhosts

```

```bash

# /etc/hostname

foxtrot

```
