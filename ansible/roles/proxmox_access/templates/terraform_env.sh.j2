# Proxmox API Configuration for {{ node_name }}
# Generated by Ansible proxmox_access role
# Source this file before running Terraform/OpenTofu

export PROXMOX_VE_ENDPOINT="https://{{ node_host }}:8006"
export PROXMOX_VE_INSECURE=true

{% for token_info in generated_tokens.values() %}
# API Token: {{ token_info.tokenid }}
export PROXMOX_VE_API_TOKEN="{{ token_info.value }}"
{% endfor %}

# OpenTofu/Terraform variables (alternative format)
{% for userid, token_info in generated_tokens.items() %}
export TF_VAR_proxmox_url="https://{{ node_host }}:8006"
export TF_VAR_proxmox_token_id="{{ userid }}!{{ token_info.tokenid }}"
export TF_VAR_proxmox_token_secret="{{ token_info.value }}"
{% endfor %}

echo "âœ… Proxmox environment configured for {{ node_name }}"
echo "   API Endpoint: https://{{ node_host }}:8006"
